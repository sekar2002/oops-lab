#include <stdio.h>
#include<stdlib.h>
struct node
{ int data;
  struct node *left;
  struct node *right;
};
struct node *create(int x,struct node *l,struct node *r)
{ struct node*t1;
  t1=(struct node *)malloc(sizeof(struct node));
  t1->data=x;
  t1->left=l;
  t1->right=r;
  return t1;
}
struct node *insert(int x,struct node *t1)
{  if(t1==NULL) 
       return create(x,NULL,NULL);
   else if(x<t1->data)
      t1->left=insert(x,t1->left);
   else
      t1->right=insert(x,t1->right);  
   return t1;
}
struct node *delete(struct node *t,int x)
{ if(t==NULL)
       return NULL;
  if(x>t->data)
      t->right=delete(t->right,x);
   if(x<t->data)
      t->left=delete(t->left,x);
    else if(x==t->data)
    { if(t->left==NULL&&t->right==NULL)
           return NULL;
       if(t->left==NULL&&t->right!=NULL)
           return (t->right);     
        if(t->left!=NULL&&t->right==NULL)
           return (t->left);
       else
        {struct node *q;
         q=t->right;
         while(q->left!=NULL)
               q=q->left;
         t->data=q->data;
         t->right=delete(t->right,q->data);
        } 
    }
  return t;
}    
    
void preorder(struct node *t1)
{ if(t1==NULL)
      return;
  else
  {  printf("%d",t1->data);
     preorder(t1->left);
     preorder(t1->right);
  }
}
void inorder(struct node *t1)
{ if(t1==NULL)
      return;
  else
  { 
     inorder(t1->left);
     printf("%d",t1->data);
     inorder(t1->right);
  }
}
void postorder(struct node *t1)
{ if(t1==NULL)
      return;
  else
  {  
     postorder(t1->left);
     postorder(t1->right);
     printf("%d",t1->data);
  }
}
int count(struct node *t)
{ if(t==NULL) return 0; 
  else
    return (1+count(t->right)+count(t->left));
}
int countleaf(struct node *t)
{ if(t==NULL) return 0;
  if(t->right==NULL&&t->left==NULL) return 1;
  else
    return (countleaf(t->left)+countleaf(t->right));
}
int countnonleaf(int x,int y)
{  int nonleaf=x-y;
   printf("No of non leaf nodes %d",nonleaf);
}
int height(struct node *t)
{ if(t==NULL) return -1;
  else
  { int x,y;
    x=height(t->left);
    y=height(t->right);
    if(x>y) return (x+1);
    else
      return (y+1);
  }
}
int search(struct node *t,int x)
{ if(t==NULL)
     { return -1;}
  if(x==t->data)
     {printf("\n element found");
      return -1;
     }
  else if(x<t->data)
      {search(t->left,x);
      }
  else
    {search(t->right,x);
    }
}
int main()
{   struct node *root=NULL;
    root=insert(50,root);
    root=insert(20,root);
    root=insert(30,root);
    root=insert(40,root);
    preorder(root);
    printf("\n");
    postorder(root);
    printf("\n");
    inorder(root);
    printf("\n");
    root=delete(root,30);
    postorder(root);
    int c;
    c=count(root); 
    printf("\n");
    printf("  no of nodes:%d",c); 
    int cleaf;
    cleaf=countleaf(root);
    printf("no of leaf nodes\n %d",cleaf);
    countnonleaf(c,cleaf);
    int h;
    h= height(root);
    printf("\n height of a tree%d",h);
    search(root,50);
    return 0;
}

